<!DOCTYPE html>
<html>
<title>Hello API</title>
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8">
</head>
<xmp theme="Slate"  style="display:none;" toc>

# words
+ order 订单
+ service 服务,订单里面包含各种服务
+ flow   流程,服务的时间流程

#access token
在报头 API-Access-Token中

# version control
在链接中指定
http://192.168.1.1:8000/v1/xxx

# error return
```json
{
    "error_msg": "An active access token must be used to query information about the current user.",
    "error_type": "OAuthException",
    "error_code": 2500 //由服务器定义
}
```

#GET alipay/:code
Req:
code:阿里授权码

#GET wexin/:code

#POST register
```json
{
   "name" : "刘正青",
   "gender" : "male",
   "phoneNumber" : "15010111335",
   "providerName" : "Alipay",
   "providerOpenId" : "JDFOSDNFSDOFJ"
}
```

#PUT login
```json
{
   "OpenId" : "JFSDFODNFOj",
}
```
#GET user_info/:id
```json
{
"user_info":
{
    "basic":
    {
        "id":1233333,
        "phone_number":"15010111335",
        "name":"刘正青",
        "gender":"male",
        "avatar_img":"http://www.baidu.com/a.png",
    },
    "location":
    [
        {
        "id":1,
        "latitude":12333.1231231,
        "longtitude":1231231.1232,
        "province_name":"湖南",
        "city_name":"长沙",
        "district_name":"雨花区",
        "stree_name":"芙蓉东路",
        "location_name":"国际大厦"
        },
    ],
    "cars":
    [
        {
            "id":1,
            "licence":
            {
                "province":"京",
                "number":"RB0718"
            },
            "bought_time":"2011-08-21T18:02:52.249Z", 
            "miles":12333,
            "chassis_numher":"HIBIY797DFS77",
            "engine_number":"DFUSODFND567DFSDN-SDFC",
            "brand":"大众",
            "category":"途观",
            "model":"豪华版 2.0T",
            "brand_img_url":"http://www.baidu.com/a.png",

            "scores":
            {
                "whole_score":78,
                "parts":[
                {
                    "name":"轮胎",
                    "status":"需更换",
                    "used_hours":123,
                    "usrd_miles":123,
                    "score":80,
                    "comment":"破损严重,建议更换",
                }
                ]
            },

        }
    ],
    "coupons":
    [
        {
            "id":1,
            "status":"已用",
            "number":"37123322",
            "value":99.00,
            "expired_time":"2011-08-21T18:02:52.249Z",
        }
    ],
"check_reports":
[
    {
        "id":1,
        "name":"报告单",
        "complete_time":"2011-08-21T18:02:52.249Z",
        "car":{
            "car_id":1,
            "licence":
            {
                "province":"京",
                "number":"RB0718"
            },
            "bought_time":"2011-08-21T18:02:52.249Z",
            "miles":12333,
            "chassis_numher":"HIBIY797DFS77",
            "engine_number":"DFUSODFND567DFSDN-SDFC",
            "brand":"大众",
            "category":"途观",
            "mode":"豪华版 2.0T",
            "brand_img_url":"http://www.baidu.com/a.png",
        },
        "reports":
        [
            {
                "name":"电瓶电压及寿命检测",
                "status":"合格",//已修复//未修复
                "stars":4,
                "status_comment":"华晨宝马行驶20000公里后电瓶XXXX,经检测发现要爆炸,需要及时更换",
                "imgs":
                [
                    "http://www.baidu.com/a.png",
                ]
            },
        ]
    }
]
},
"order_infos":[
{
    "id":1,
    "name":"常规保养",
    "status":"初检中",
    "keeper_id",123,
    "keeper_name":"张师傅",
    "place_time":"2011-08-21T18:02:52.249Z", //  下单时间
    "start_time":"2011-08-21T18:02:52.249Z",  // 接单时间
    "order_services":[
        {
            "id":12,
            "type":"保养",
            "name":"机滤通用",
            "unit":"升",
            "unit_count":1,
            "price":123.00,
        }
    ],
    "order_flow":[
        {
            "id" : 1,
            "name":"接车",
            "status":"已完成",
            "complete_time":"2011-08-21T18:02:52.249Z",
            "location":"中关村南大街",
            "imgs":[
            "http://www.baidu.com/a.png",
            "http://www.baidu.com/b.png",
            ]
        },
        {
            "id" : 2,
            "name":"保养",
            "status":"未完成",
        }
    ],
    "client_feedback":
    {
        "comment":"非常不错,下次再来!",
        "keeper_stars":4,
        "order_stars":5,
    }

}
],
"carcare_book":[ //保养手册
{
    "car_id":1,
    "history":[
        {
            "miles":10000,
            "events":[
            {
                "name":"检测机滤",
                "status":"未完成",//完成,
            }
            ]
        }
    ]
}
],

}
```
 
#GET brands
```json
[
   {
    "id":1,
    "name":"大众",
    "img_url":"http://www.baidu.com/a.png",
    "categories":
    [
       {
       "brand_name":"大众",
       "name":"途观",
       "modoles":[
            "豪华版 2.0T",
            "豪华版 3.0T"
       ],
       }
    ],
   }
]

```
 
 
#GET wechatpay/:orderid
```json
{
"appId":"wxd930ea5d5a258f4f",
"timeStamp": "1399514976",
"nonceStr": "e7d161ac8d8a76529d39d9f5b4249ccb",
"package":
"bank_type=WX&body=%E6%94%AF%E4%BB%98%E6%B5%8B%E8%AF%95&fee_ty
pe=1&input_charset=UTF-8&notify_url=http%3A%2F%2Fweixin.qq.com&out_trade_no=7240b
65810859cbf2a8d9f76a638c0a3&partner=1900000109&spbill_create_ip=196.168.1.1&total_fee=
1&sign=7F77B507B755B3262884291517E380F8",
"signType" : "SHA1",
"paySign" : "8893870b9004ead28691b60db97a8d2c80dbfdc6"
}
```
Res
```json
{
    //todo @王帅
}
```

#POST  payment
```json
Req:
{
    "order_id":123,
}
```
```json
Res:
{
    "status":"OK"
}
```

#GET orders

```json
{
    "order_infos":[
    {
        "id":1,
        "name":"常规保养",
        "status":"初检中",
        "keeper_name":"张师傅",
        "place_time":"2011-08-21T18:02:52.249Z", //  下单时间
        "start_time":"2011-08-21T18:02:52.249Z",  // 接单时间
        "order_services":[
            {
                "id":12,
                "type":"保养",
                "name":"机滤通用",
                "unit":"升",
                "unit_count":1,
                "price":123.00,
            }
        ],
        "order_flow":[
            {
                "id" : 1,
                "name":"接车",
                "status":"已完成",
                "complete_time":"2011-08-21T18:02:52.249Z",
                "location":"中关村南大街",
                "imgs":[
                "http://www.baidu.com/a.png",
                "http://www.baidu.com/b.png",
                ]
            },
            {
                "id" : 2,
                "name":"保养",
                "status":"未完成",
            }
        ],
        "client_feedback":
        {
            "comment":"非常不错,下次再来!",
            "keeper_stars":4,
            "order_stars":5,
        }
    
    }
    ]
}

```
#DELETE order/:order_id
``json
Res:
{
    "status":"OK" 
}
```
#POST orders
request:
```json
{
    "order_type":"care",
    "order_name":"常规保养",
    "car_id":1555,
    "keeper_id":123,
    "pick_location":"曼陀山庄20号",
    "phone_number":"1501011335",
    "contact_name":"小龙女",
    "paid":false,
    "order_services":[
        {
            "type":"保养",
            "name":"机滤通用",
            "unit":"升",
            "unit_count":1,
            "price":123.00,
        }
    ],
    "comment":"早点来"
}

```
response
```json
{
   "order": {
        "id":1,
        "name":"常规保养",
        "status":"初检中",
        "keeper_id":123,
        "keeper_name":"张师傅",
        "place_time":"2011-08-21T18:02:52.249Z", //  下单时间
        "start_time":"2011-08-21T18:02:52.249Z",  // 接单时间
        "order_services":[
            {
                "id":12,
                "type":"保养",
                "name":"机滤通用",
                "unit":"升",
                "unit_count":1,
                "price":123.00,
            }
        ],
        "order_flow":[
            {
                "id" : 1,
                "name":"接车",
                "status":"已完成",
                "complete_time":"2011-08-21T18:02:52.249Z",
                "location":"中关村南大街",
                "imgs":[
                "http://www.baidu.com/a.png",
                "http://www.baidu.com/b.png",
                ]
            },
            {
                "id" : 2,
                "name":"保养",
                "status":"未完成",
            }
        ],
        "client_feedback":
        {
            "comment":"非常不错,下次再来!",
            "keeper_stars":4,
            "order_stars":5,
        }
    
    }
}
```
 
#POST feedback
```json
{
    "order_id":1,
    "client_feedback":
    {
        "comment":"非常不错,下次再来!",
        "keeper_stars":4,
        "order_stars":5,
    }
}
```
#DELETE car/:car_id
```json
Res:
{
    "status":"OK"
}
```
#POST car
REQ:
```json
{
      
    "licence":
    {
        "province":"京",
        "number":"RB0718"
    },
    "bought_time":"2011-08-21T18:02:52.249Z", 
    "miles":12333,
    "chassis_numher":"HIBIY797DFS77",
    "engine_number":"DFUSODFND567DFSDN-SDFC",
    "brand":"大众",
    "category":"途观",
    "model":"豪华版 2.0T",
}
```
Res:
```json
{
    "car":
    {
      "id":1,
      "licence":
      {
          "province":"京",
          "number":"RB0718"
      },
      "bought_time":"2011-08-21T18:02:52.249Z", 
      "miles":12333,
      "chassis_numher":"HIBIY797DFS77",
      "engine_number":"DFUSODFND567DFSDN-SDFC",
      "brand":"大众",
      "category":"途观",
      "model":"豪华版 2.0T",
      "brand_img_url":"http://www.baidu.com/a.png",
    }
}
```
 

#GET coupons
```json 
{
 "coupons":
    [
        {
            "id":1,
            "status":"已用",
            "number":"37123322",
            "value":99.00,
            "expired_time":"2011-08-21T18:02:52.249Z",
        }
    ]
    }
```

#POST coupon
    兑换优惠码
Req:
```json
{
"code":"dfdfson",
}
```
Res:
```json
{
 "coupon":

        {
            "id":1,
            "status":"已用",
            "number":"37123322",
            "value":99.00,
            "expired_time":"2011-08-21T18:02:52.249Z",
        }

}
```

#POST phone_code_request
    请求手机验证码
```json
{
"phone_number":"15010111335"
}
```

#POST phone_code_verification
    核实手机验证码
```json
{
"phone_number":"15010111335"
}
```



#GET services/:id
RES:
```json
[    {
    "carModelId": 610,
    "carServiceType": "Maintenance",
    "product": {
        "id": 9,
        "createTime": 1414807200000,
        "lastModified": 1416383463000,
        "type": "EngineOil",
        "name": "蓝壳",
        "description": "蓝壳",
        "price": 68.0,
        "tax": 2.0
    },
    "quantity": 4,
    "price": 0.0
}, {
    "carModelId": 610,
    "carServiceType": "Maintenance",
    "product": {
        "id": 10,
        "createTime": 1414807200000,
        "lastModified": 1414807200000,
        "type": "EngineOil",
        "name": "黄壳",
        "description": "黄壳",
        "price": 40.0,
        "tax": 2.0
    },
    "quantity": 4,
    "price": 0.0
}]

```

#POST cart
REQ:
```json
{
    "name":"常规保养",
     "car_id",1,
     "contact_name":"王语嫣",
     "contact_phone_number":"15010111335",
     "use_coupon_id":[1,3],
     "serivces":[
        {
            "type":"机油",
        },
        {
            "type":"机滤",
        }
     ]
     "comment":"要两瓶",
     "pick_time_segment":[
        "2011-08-21T18:02:52.249Z",
        "2011-08-21T18:03:52.249Z"
     ],
     "location":{
        "latitude":12333.1231231,
        "longtitude":1231231.1232,
        "province_name":"湖南",
        "city_name":"长沙",
        "district_name":"雨花区",
        "stree_name":"芙蓉东路",
        "location_name":"国际大厦"
        },
    "order_services":[
        {
            "id":12,
            "type":"保养",
            "name":"机滤通用",
            "unit":"升",
            "unit_count":1,
            "price":123.00,
        }
    ],
}

```

</xmp>
<!-- <script src="http://strapdownjs.com/v/0.2/strapdown.js"></script> -->
<script src="http://ndossougbe.github.io/strapdown/dist/strapdown.js"></script>
</html>
